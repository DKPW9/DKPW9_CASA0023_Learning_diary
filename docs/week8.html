<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Remotely Sensing Cities and Environments: Learning Diary - 8&nbsp; SAR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week7.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week8.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">SAR</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Remotely Sensing Cities and Environments: Learning Diary</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Personal introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to remote sensing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Xaringan</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Corrections</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Policy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Google Earth Engine</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classification (i)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Classification (ii)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week8.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">SAR</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary"><span class="header-section-number">8.1</span> Summary</a></li>
  <li><a href="#applications" id="toc-applications" class="nav-link" data-scroll-target="#applications"><span class="header-section-number">8.2</span> Applications</a></li>
  <li><a href="#reflections" id="toc-reflections" class="nav-link" data-scroll-target="#reflections"><span class="header-section-number">8.3</span> Reflections</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">8.4</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">SAR</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="summary" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">8.1</span> Summary</h2>
<p>This week we pivoted from passive optical images to another type of remote sensing; synthetic aperture radar aka SAR! SAR sensors produce their own energy and then record the amount of that energy reflected back after interacting with the Earth, requiring a unique way of interpreting the data as the signal obtained is responsible to surface characteristics like topography and moisture. To summarise this week’s content I returned to a handwritten approach (as used in weeks 1 and 3) which is pictured below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week8_summary.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Week 8 SAR summary</figcaption>
</figure>
</div>
<p>The key things to remember from this week’s content serve as the subheadings in the above mind map. I was particularly excited to finally experience that penny-drop feeling when realising that several papers I had read over the past few weeks had utilised SAR data, celebrating its strengths over optical data for certain applications (specifically for night-time monitoring + observations over frequently cloudy study sites). That was probably what I found most interesting from this week’s content - understanding the humongous potential for observation when using a combination of both passive and active sensor data in research! That, and of course discussion of interferometry. Having worked on a 2-man interferometry team at a job I had in London last summer, I think I’ll be forever amazed by not only the power it holds for obtaining incredibly precise ground measurements, but also by the crazy rainbow appearance of an inteferogram.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="inteferogram.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Example of an unwrapped interferogram generated by SNAP user vin15carter. Source: <a href="https://forum.step.esa.int/t/interferogram-and-displacement-comparison-between-snap-and-diapason-in-gep/5750">STEP Forum</a>, 2017</figcaption>
</figure>
</div>
</section>
<section id="applications" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="applications"><span class="header-section-number">8.2</span> Applications</h2>
<p>Combining my interest in InSAR with the fascinating discussion of Ollie Ballinger’s work on detecting building damage in conflict affected areas, I have decided to dedicate this applications section to exploring this line of research more thoroughly. As my dissertation is focusing on predicting terrorism + associated conflict risk, I was really excited to delve into the topic more!</p>
<p>The first paper that I came across outlined the work that <a href="https://www.mdpi.com/2220-9964/10/3/140">Boloorani <em>et al.,</em></a>2021 had done using InSAR to map post-war urban damage in Mosul, Iraq. They sought to assess the feasibility of implementing InSAR techniques on Sentinel-1 data to estimate post-war damage as an alternative to using commerical high-res optical imagery. What I thought was really curious about this paper was that they assessed their outputs to a UN (UNITAR) damage map that had been commissioned by the Iraqi government after the Battle of Mosul in 2016-2017 - a map that had been generated using a combination of data sources including drone imagery, satellite images and field visits to create a post-war damage map.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="UNmap.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Mosul damage severity map. Source: <a href="https://unosat.docs.cern.ch/unosat-maps/IQ/CE20140613IRQ/UNOSAT_A3_Mosul_damage_assessment_4August2017_Landscape2_o.pdf">UNITAR-UNOSAT</a>, 2019</figcaption>
</figure>
</div>
<p>What this meant was that the discussion of the study’s successes/accuracy hinged almost entirely on comparison between study outputs and the above UN map. Before I launch into a critique of this, I do want to confess that I really liked the way in which they tested + graphically presented the comparison between the two - it seems really intuitive to me which is a nice break from the sometimes unintelligible analysis that I see in similar papers using InSAR techniques.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="resultsUN.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Cross comparison of the UNITAR results with the study’s displacement map (called SBAS). The authors overlayed the UN’s damage severity points over the study’s gridded damage map to demonstrate how, at the local level, the two differed. Source: Boloorani et al., 2021</figcaption>
</figure>
</div>
<p>Reading the discussion section of this paper, I couldn’t shake what Ollie said out of my mind. He spoke about how often, in the case of machine learning + remote sensing research, the results of accuracy assessments were disorted as overfitting was prevalent, thereby preventing opportunities to re-use a method in a new study location. It feels as though a similar issue affects this research. What would happen if they ran the same processes on say, Yemen, if there were no maps to support cross comparison? It seems to me at least, that there would be no proper way to assess the accuracy of outputs. Not only that, but the way that the discussion section is written suggests that strong prior ground knowledge of the war is important in interpretation efforts. This left me feeling ever so slightly frustrated, as I feel like I got lured in with a snappy title, a slick abstract and a series of interesting looking maps. It’s only at the end of the paper that the authors admit that whilst InSAR <em>can</em> capture damage, it’s probably only really useful when integrated with other data sources like the UN map. Even more than that, they also describe failings of the technique to detect a sudden decrease in building height and a strong reliance on ground data - a luxury often impossible in conflict-affected areas. Undoutbedly, the final line of the paper rings true: ‘This could be an issue to be followed in future research’.</p>
<p>In some of the ways in which <a href="https://www.mdpi.com/2220-9964/10/3/140">Boloorani <em>et al.,</em></a>2021 went wrong, I believe <a href="https://www.mdpi.com/2072-4292/14/24/6239">Aimaiti <em>et al.</em></a> 2022 built upon and improved. They sought to assess building damage caused by war in Ukraine using Sentinel-1 SAR data and Sentinel-2 optical images, comparing their results to a UN Satellite Centre (UNOSAT) damage assessment map. Right off the bat, the authors acknowledge the problems acquiring ground truth data in the ongoing war zone, describing how for this reason their accuracy assessments are twofold, both qualitative and quantitative. These assessments are integrated into the study’s methodology and are frequently referred back to throughout the text, demonstrating the authors awareness of the study’s inherent limitations.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="workflowUkraine.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Building damage mapping workflow. I particularly like the way that the validation of results is presented here. Source: <a href="https://www.mdpi.com/2072-4292/14/24/6239">Aimaiti <em>et al.</em></a> 2022</figcaption>
</figure>
</div>
<p>Also unlike <a href="https://www.mdpi.com/2220-9964/10/3/140">Boloorani <em>et al.,</em></a>2021’s paper, <a href="https://www.mdpi.com/2072-4292/14/24/6239">Aimaiti <em>et al.</em></a> 2022 provide much more specific + detailed information about the steps they took throughout their methodology which is nice to see as all too often I feel like I read papers that I have 0 chance of recreating myself due to the lack of processing information.</p>
<p>In terms of results, <a href="https://www.mdpi.com/2072-4292/14/24/6239">Aimaiti <em>et al.</em></a> 2022 obtained some slightly confusing outputs - there were a few locations where damage detected by Sentinel-1 contradicted results from Sentinel-2. Broadly however, they found that the contribution to damage classification by either data type depended on the scale at which change was assessed; S1 showed small to large scale damaged buildings, while optical texture-based analysis mainly showed the large-scale damaged buildings. Similar to <a href="https://www.mdpi.com/2220-9964/10/3/140">Boloorani <em>et al.,</em></a>2021, they presented their findings relative to the UN map in a simple graphical format.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="resultsUkraine.webp" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">The comparison of the Sentinel-1 SAR intensity-based results with the UNOSAT's building damage assessment report. Source: <a href="https://www.mdpi.com/2072-4292/14/24/6239">Aimaiti <em>et al.</em></a> 2022</figcaption>
</figure>
</div>
<p>Overall, I preferred this paper for several reasons. Besides those already mentioned, I feel as though this was written in a more self-aware way; by that, I mean that rather than selling the dream of a valuable methodology for detecting building damage in conflict afflicted areas and then admitting to falling short within the final few lines of the discussion section, <a href="https://www.mdpi.com/2072-4292/14/24/6239">Aimaiti <em>et al.</em></a> 2022 are more critical and display a greater consciousness of the challenges inherent to this task throughout. Moreover, I really like the way that they integrate both active and passive remotely sensed data into their analysis, as this makes results more robust. Finally, I like the direction in which they suggest future research to be aimed, describing a keen interest to ‘extend the framework to detect other war related damages, such as damages to agricultural sectors, and road/infrastructure non-building damages’.</p>
<p>All in all, I think that both of these papers clearly demonstrate both the case that Ollie was making in the lecture and the discussion of accuracy assessments from the week prior - in all contexts, there are challenges to assessing the accuracy and success of a technique in making detailed observations from space. But moreso than any other context, when conflict is affecting an area this becomes even more challenging. This remains a fertile and <em>incredibly</em> pressing area of research which will only benefit from more work being conducted.</p>
<p>Unrelated to all of this but something cool that I saw when doing some reading was about the use of interferometry in art restoration. Turns out it’s a technique that is used quite widely by restoration specialists in detecting where otherwise invisible defects are in paintings. It is increasingly becoming a vital structural diagnosis tool and supports conservation efforts.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="art.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Painting of Saint Sebastian (left), its holographic interferogram (right). The technique was used here to identify the location of structural defects in the painting’s wooden panelling. Source: <a href="http://www.science4heritage.org/COSTG7/booklet/chapters/holo.htm">Tornari, 2008</a></figcaption>
</figure>
</div>
<p>From art to conflict studies, interferometry has us all covered!</p>
</section>
<section id="reflections" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="reflections"><span class="header-section-number">8.3</span> Reflections</h2>
<p>I really really loved this week’s content - in fact, I’d actually say that of all the weeks, this has been my favourite. It really felt like a lot of the things we had been discussing came together in one, especially when using conflict and war as the lens to consider the content through. Currently, I’m planning on creating a spatial risk map of terrorism in Nigeria for my dissertation using a Bayesian framework. However after this week, I’m strongly considering pivoting my research to include remotely sensed data to see whether or not this could be a valuable input in my risk analysis. I truly believe this is an incredibly important area of research and I look forward to seeing Ollie’s paper get published as his lecture really stuck with me.</p>
<p>I also wanted to briefly mention how much I’ve enjoyed this assessment style. To avoid sounding like I’m begging for a better mark through praise, it has been really nice to have the opportunity to really engage with published literature and see how the concepts that we get taught in a theoretical way can be used actively in really interesting/diverse fields. I really feel as though I’ve come a long way from week 1 in terms of the way I engage with and critique the literature that I come across. In the past I’d always felt hesitant to say anything that wasn’t complimentary about published work, as it felt a bit rich given that it wasn’t like <em>I</em> knew how to do what the authors did. Having now fully learnt about sensors, methods and even having trialed them myself during the practicals, I feel much more confident overall about my understanding and my opinions. It’s cool - I think this is actually something that will stay with me from here on out. Cheers CASA.</p>
<p>So that concludes my learning diary! I hope you’ve enjoyed it - I definitely have!</p>
</section>
<section id="references" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="references"><span class="header-section-number">8.4</span> References</h2>
<ol type="1">
<li>Aimaiti, Y., Sanon, C., Koch, M., Baise, L.G., Moaveni, B. (2022) ‘War related building damage assessment in Kyiv, Ukraine, using Sentinel-1 radar and Sentinel-2 optical images’. <em>Remote Sensing,</em> vol.&nbsp;14, is. 24.</li>
<li>Boloorani, A.D., Darvishi, M., Weng, Q., Liu, X. (2021) ‘Post-war Urban Damage Mapping Using InSAR: The Case of Mosul City in Iraq’. <em>ISPRS Int. J. Geo-Inf.,</em> vol.&nbsp;10, is. 3.</li>
<li>Tornari, V. (2008) ‘Handbook on the use of lasers in conservation and conservation science’. COST Office: Warsaw.</li>
<li>vin15carter via STEP Forum (2017) ‘Interferogram and displacement comparison between SNAP and DIAPASON in GEP’. Web page, available at: https://forum.step.esa.int/t/interferogram-and-displacement-comparison-between-snap-and-diapason-in-gep/5750</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week7.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Classification (ii)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>